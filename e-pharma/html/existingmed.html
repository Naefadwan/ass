<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medicines - E-Pharma</title>
    <link rel="stylesheet" href="/e-pharma/css/exiisting.css">
    <link rel="stylesheet" href="/e-pharma/css/styles.css">
    <script src="../JS/cart.js"></script>

    <script src="../js/script.js" type="text/javascript"></script>
    <script src="../js/medicines.js" type="text/javascript"></script>
    <script src="../JS/header-fix.js"></script>
    <script src="../JS/user-auth-final.js"></script>
    <script src="../JS/navbar-role-control.js"></script>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <a href="home2.html">
                    <div class="logo-icon">
                        <svg viewBox="0 0 100 100" width="40" height="40">
                            <circle cx="50" cy="50" r="48" fill="#1a73e8"></circle>
                            <circle cx="50" cy="50" r="38" fill="white"></circle>
                            <rect x="47" y="20" width="6" height="60" rx="2" fill="#1a73e8"></rect>
                            <rect x="20" y="47" width="60" height="6" rx="2" fill="#1a73e8"></rect>
                        </svg>
                    </div>
                    <h1>E-Pharma</h1>
                </a>
            </div>
            
            <nav>
                <ul>
                    <li><a href="home2.html">Home</a></li>
                    <li><a href="existingmed.html" class="active">Medicines</a></li> <!-- Changed -->
                    <li><a href="location.html">Locations</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </nav>
            
            <div class="auth-buttons">
                <a href="login.html" class="btn btn-outline">Login</a>
                <a href="register.html" class="btn btn-primary">Sign Up</a>
            </div>
            
            <button class="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <section class="page-header">
        <div class="container">
            <h2>Medicines Catalog</h2>
            <p>Browse our wide selection of medications and health products</p>
        </div>
    </section>

    <section class="medicines-section">
        <div class="container">
            <div class="filters">
                <div class="search-box">
                    <input type="text" id="medicine-search" placeholder="Search medicines...">
                    <button><i class="fas fa-search"></i></button>
                </div>
                
                <div class="filter-options">
                    <select id="category-filter">
                        <option value="">All Categories</option>
                        <option value="Pain Relief">Pain Relief</option>
                        <option value="Antibiotics">Antibiotics</option>
                        <option value="Allergy Relief">Allergy Relief</option>
                        <option value="Digestive Health">Digestive Health</option>
                        <option value="Vitamins & Supplements">Vitamins & Supplements</option>
                    </select>
                    
                    <select id="sort-by">
                        <option value="name-asc">Name (A-Z)</option>
                        <option value="name-desc">Name (Z-A)</option>
                        <option value="price-asc">Price (Low to High)</option>
                        <option value="price-desc">Price (High to Low)</option>
                    </select>
                    
                    <div class="stock-filter">
                        <input type="checkbox" id="in-stock-only" name="stock-filter">
                        <label for="in-stock-only">In Stock Only</label>
                    </div>
                </div>
            </div>
            
            <div class="medicine-grid" id="medicine-grid">
                <!-- Medicine cards will be dynamically inserted here -->
            </div>
            
            <div class="pagination">
                <button id="prev-page" class="btn btn-outline" disabled>Previous</button>
                <span id="current-page">Page 1</span>
                <button id="next-page" class="btn btn-outline">Next</button>
            </div>
            
            <div id="loading" class="loading-indicator">
                <div class="spinner"></div>
                <p>Loading medicines...</p>
            </div>
            
            <div id="no-results" class="no-results" style="display: none;">
                <i class="fas fa-search"></i>
                <p>No medicines found matching your search.</p>
            </div>
        </div>
    </section>

    <div class="cart-popup" id="cart-popup">
        <div class="cart-header">
            <h3>Your Cart</h3>
            <button id="close-cart"><i class="fas fa-times"></i></button>
        </div>
        
        <div class="cart-items" id="cart-items">
            <!-- Cart items will be dynamically inserted here -->
        </div>
        
        <div class="cart-footer">
            <div class="cart-total">
                <span>Total:</span>
                <span id="cart-total-amount">$0.00</span>
            </div>
            <button class="btn btn-primary btn-block">Checkout</button>
        </div>
    </div>

    <div class="cart-button" id="cart-button">
        <i class="fas fa-shopping-cart"></i>
        <span id="cart-count">0</span>
    </div>

    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="home2.html">Home</a></li>
                        <li><a href="existingmed.html">Medicines</a></li>
                        <li><a href="location.html">Locations</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                
                <div class="footer-col">
                    <h3>Customer Support</h3>
                    <ul>
                        <li><a href="help-center.html">Help Center</a></li>
                        <li><a href="contact.html">Contact Us</a></li>
                        <li><a href="faq.html">FAQ</a></li>
                        <li><a href="shipping-returns.html">Shipping & Returns</a></li>
                    </ul>
                </div>
                
                <div class="footer-col">
                    <h3>Legal</h3>
                    <ul>
                        <li><a href="privacy-policy.html">Privacy Policy</a></li>
                        <li><a href="ToS.html">Terms of Service</a></li>
                        <li><a href="Compliance.html">Compliance</a></li>
                        <li><a href="Accessibility.html">Accessibility</a></li>
                    </ul>
                </div>
                
                <div class="footer-col">
                    <h3>Connect With Us</h3>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-linkedin"></i></a>
                    </div>
                    <p>Email: support@epharma.com</p>
                    <p>Phone: +962 12 345 6789</p>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 E-Pharma. All rights reserved.</p>
            </div>
        </div>
    </footer>


    
    <!-- Add header.js to make auth buttons update -->
    <script type="module" src="../JS/header.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // CART POPUP TOGGLE
        const cartButton = document.getElementById('cart-button');
        const cartPopup = document.getElementById('cart-popup');
        const closeCart = document.getElementById('close-cart');
        const checkoutBtn = document.querySelector('.cart-popup .btn.btn-primary.btn-block');

        // Remove previous event listeners if any (defensive)
        cartButton.onclick = null;
        if (closeCart) closeCart.onclick = null;
        if (checkoutBtn) checkoutBtn.onclick = null;

        // Toggle cart popup
        cartButton.addEventListener('click', function(e) {
            e.stopPropagation();
            cartPopup.style.display = (cartPopup.style.display === 'block' ? 'none' : 'block');
        });
        // Close cart popup
        if (closeCart) {
            closeCart.addEventListener('click', function() {
                cartPopup.style.display = 'none';
            });
        }
        // Hide cart popup on outside click
        document.addEventListener('click', function(e) {
            if (!cartPopup.contains(e.target) && e.target !== cartButton) {
                cartPopup.style.display = 'none';
            }
        });
        // Checkout button
        if (checkoutBtn) {
            checkoutBtn.addEventListener('click', function() {
                window.location.href = 'checkout.html';
            });
        }

        // ENSURE ADD-TO-CART ALWAYS ADDS 1 ITEM
        document.querySelectorAll('.add-to-cart').forEach(btn => {
            btn.onclick = null;
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                const id = btn.dataset.id;
                const name = btn.dataset.name;
                const price = parseFloat(btn.dataset.price);
                const image = btn.dataset.image;
                if (typeof ShoppingCart !== 'undefined' && ShoppingCart.addItem) {
                    ShoppingCart.addItem({ id, name, price, image, quantity: 1 });
                }
            });
        });
    });
    </script>
</body>
</html>
